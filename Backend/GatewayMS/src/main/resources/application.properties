
spring.application.name=GATEWAYMS
server.port=8082

# Eureka client configuration
#eureka.client.service-url.defaultZone=http://localhost:8761/eureka/
eureka.client.service-url.defaultZone=${EUREKA_SERVER:http://localhost:8761/eureka/}
eureka.client.register-with-eureka=true
#profilems.url=${PROFILEMS_URL:http://localhost:8083}
app.cors.allowed-Origins=${CORS_ALLOWED_RUL:http://localhost:3000}
#eureka.client.register-with-eureka=true
eureka.client.fetch-registry=true
eureka.instance.hostname=localhost
eureka.instance.prefer-ip-address=false

# Enable discovery for load-balanced routes
spring.cloud.gateway.discovery.locator.enabled=true
spring.cloud.discovery.enabled=true

# Gateway defaults and CORS
spring.cloud.gateway.default-filters[0]=DedupeResponseHeader=Access-Control-Allow-Origin RETAIN_UNIQUE
spring.cloud.gateway.globalcors.add-to-simple-url-handler-mapping=true
spring.cloud.gateway.globalcors.corsConfigurations.[/**].allowedOrigins=${ALLOWED_ORIGINS:http://localhost:3000}
spring.cloud.gateway.globalcors.corsConfigurations.[/**].allowedMethods=GET,POST,PUT,DELETE,OPTIONS
spring.cloud.gateway.globalcors.corsConfigurations.[/**].allowedHeaders=*
spring.cloud.gateway.globalcors.corsConfigurations.[/**].allowCredentials=true

# JSON / timezone
spring.jackson.date-format=yyyy-MM-dd HH:mm:ss
spring.jackson.time-zone=Asia/Kolkata

# Routes (using discovery / load-balancer via lb://SERVICE)
spring.cloud.gateway.routes[0].id=MEDIA
spring.cloud.gateway.routes[0].uri=${MEDIA_URL:lb://MEDIA}
spring.cloud.gateway.routes[0].predicates[0]=Path=/api/media/**
spring.cloud.gateway.routes[0].filters[0]=TokenFilter

spring.cloud.gateway.routes[1].id=USERMS
spring.cloud.gateway.routes[1].uri=${USERMS_URL:lb://USERMS}
spring.cloud.gateway.routes[1].predicates[0]=Path=/api/users/**
spring.cloud.gateway.routes[1].predicates[1]=Method=POST,GET
spring.cloud.gateway.routes[1].filters[0]=TokenFilter

#PROFILE MS
spring.cloud.gateway.routes[2].id=PROFILEMS
spring.cloud.gateway.routes[2].uri=${PROFILEMS_URL:lb://PROFILEMS}
spring.cloud.gateway.routes[2].predicates[0]=Path=/api/profile/**
spring.cloud.gateway.routes[2].predicates[1]=Method=POST,GET,PUT,DELETE
spring.cloud.gateway.routes[2].filters[0]=TokenFilter

#APPOINTMENT MS
spring.cloud.gateway.routes[3].id=APPOINTMENT
spring.cloud.gateway.routes[3].uri=${APPOINTMENT_URL:lb://APPOINTMENT}
spring.cloud.gateway.routes[3].predicates[0]=Path=/api/appointment/**
spring.cloud.gateway.routes[3].predicates[1]=Method=POST,GET,PUT,DELETE
spring.cloud.gateway.routes[3].filters[0]=TokenFilter

#PHARMACY MS
spring.cloud.gateway.routes[4].id=PHARMACY
spring.cloud.gateway.routes[4].uri=${PHARMACY_URL:lb://PHARMACY} 
spring.cloud.gateway.routes[4].predicates[0]=Path=/api/pharmacy/**
spring.cloud.gateway.routes[4].predicates[1]=Method=POST,GET,PUT,DELETE
spring.cloud.gateway.routes[4].filters[0]=TokenFilter